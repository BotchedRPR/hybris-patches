From 89d85090108fa67e1964f63f4c34480db6d48531 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Matti=20Lehtim=C3=A4ki?= <matti.lehtimaki@gmail.com>
Date: Fri, 21 Apr 2023 14:26:31 +0500
Subject: [PATCH] (hybris) Use mini services and disable starting unneeded
 services.

Change-Id: I25030a53012639d30d25c9b52cae662195aa3d14
---
 cmds/servicemanager/servicemanager.rc | 24 ++++++++++++++++++++----
 1 file changed, 20 insertions(+), 4 deletions(-)

diff --git a/cmds/servicemanager/servicemanager.rc b/cmds/servicemanager/servicemanager.rc
index e5d689f..b7bfd55 100644
--- a/cmds/servicemanager/servicemanager.rc
+++ b/cmds/servicemanager/servicemanager.rc
@@ -3,11 +3,27 @@ service servicemanager /system/bin/servicemanager
     user system
     group system readproc
     critical
-    onrestart restart apexd
-    onrestart restart audioserver
-    onrestart restart gatekeeperd
-    onrestart class_restart --only-enabled main
+    #onrestart restart apexd
+    #onrestart restart audioserver
+    #onrestart restart gatekeeperd
+    #onrestart class_restart --only-enabled main
     onrestart class_restart --only-enabled hal
     onrestart class_restart --only-enabled early_hal
     task_profiles ServiceCapacityLow
     shutdown critical
+
+service minimedia /system/bin/minimediaservice
+    class main
+    user media
+    group audio camera
+    ioprio rt 4
+
+service minisf /system/bin/minisfservice
+    class main
+    user system
+    group graphics
+
+service miniaf /system/bin/miniafservice
+    class main
+    user system
+    group audio
-- 
2.39.2

