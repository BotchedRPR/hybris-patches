From b006a1581e07af85e0466362cf6b6c8b2dc36efb Mon Sep 17 00:00:00 2001
From: Florian Leeber <florian@ubports.com>
Date: Wed, 5 Jan 2022 22:13:58 +0100
Subject: [PATCH] Remove libdl-static from being a requirement for static gpg

Change-Id: I07ab588c3d08d2fb0e016adb94c646e6539b86cb
---
 Android.mk     | 16 ----------------
 g10/Android.mk |  2 +-
 2 files changed, 1 insertion(+), 17 deletions(-)

diff --git a/Android.mk b/Android.mk
index 90a99c8..04c9313 100644
--- a/Android.mk
+++ b/Android.mk
@@ -3,22 +3,6 @@
 LOCAL_PATH:=$(call my-dir)
 gpg_local_path := $(LOCAL_PATH)
 
-#
-# build static version of libdl from bionics
-#
-
-include $(CLEAR_VARS)
-LOCAL_LDFLAGS := -Wl,--exclude-libs=libgcc.a
-# for x86, exclude libgcc_eh.a for the same reasons as above
-ifeq ($(TARGET_ARCH),x86)
-LOCAL_LDFLAGS += -Wl,--exclude-libs=libgcc_eh.a
-endif
-LOCAL_SRC_FILES:= ../../bionic/libdl/libdl.cpp
-LOCAL_MODULE:= libdl-static
-LOCAL_ADDITIONAL_DEPENDENCIES := $(LOCAL_PATH)/Android.mk
-LOCAL_ALLOW_UNDEFINED_SYMBOLS := true
-include $(BUILD_STATIC_LIBRARY)
-
 # gpg
 include $(CLEAR_VARS)
 
diff --git a/g10/Android.mk b/g10/Android.mk
index 12b1a5b..6aafa97 100644
--- a/g10/Android.mk
+++ b/g10/Android.mk
@@ -81,7 +81,7 @@ LOCAL_CFLAGS := \
 LOCAL_CFLAGS += -DHAVE_CONFIG_H -Wno-error
 
 LOCAL_STATIC_LIBRARIES += libgpgcipher libgpgutil libgpgmpi libgpgintl libgpgcompat
-LOCAL_STATIC_LIBRARIES += libc libz libdl-static
+LOCAL_STATIC_LIBRARIES += libc libz
 
 LOCAL_MODULE:= static_gpg
 LOCAL_MODULE_CLASS := RECOVERY_EXECUTABLES
-- 
2.17.1

