From e9e08887b93efbea2c9af47e1b5394ba89fa030e Mon Sep 17 00:00:00 2001
From: Franz-Josef Haider <franz.haider@jolla.com>
Date: Mon, 12 Oct 2020 19:25:00 +0000
Subject: [PATCH 46/50] (hybris) execve service

Signed-off-by: Simonas Leleiva <simonas.leleiva@jolla.com>
Change-Id: I2efa4048bc2e4da848a61e24d8ef8b1824a81f06
---
 init/service.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/init/service.cpp b/init/service.cpp
index e77423eea..894951a1e 100644
--- a/init/service.cpp
+++ b/init/service.cpp
@@ -190,7 +190,6 @@ Result<Success> Service::EnterNamespaces() const {
     return Success();
 }
 
-/*
 static bool ExpandArgsAndExecv(const std::vector<std::string>& args, bool sigstop) {
     std::vector<std::string> expanded_args;
     std::vector<char*> c_strings;
@@ -213,6 +212,7 @@ static bool ExpandArgsAndExecv(const std::vector<std::string>& args, bool sigsto
 }
 
 
+/*
 static bool IsRuntimeApexReady() {
     struct stat buf;
     return stat("/apex/com.android.runtime/", &buf) == 0;
@@ -1066,6 +1066,7 @@ Result<Success> Service::Start() {
             }
         }
 
+#endif
         if (needs_console) {
             setsid();
             OpenConsole();
@@ -1081,7 +1082,6 @@ Result<Success> Service::Start() {
             PLOG(ERROR) << "cannot execve('" << args_[0] << "')";
         }
 
-#endif
         _exit(127);
     }
 
-- 
2.23.0

