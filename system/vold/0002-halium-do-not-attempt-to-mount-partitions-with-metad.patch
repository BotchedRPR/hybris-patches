From 23dca0e7061bb3917ad0f3822eed095aff29ab6d Mon Sep 17 00:00:00 2001
From: TheKit <nekit1000@gmail.com>
Date: Fri, 21 Apr 2023 15:20:25 +0500
Subject: [PATCH] (halium) do not attempt to mount partitions with metadata
 encryption

Change-Id: Icdab66b868b722224e53568ce9d75025f7b7a167
---
 MetadataCrypt.cpp | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/MetadataCrypt.cpp b/MetadataCrypt.cpp
index 50943fc..ab467be 100644
--- a/MetadataCrypt.cpp
+++ b/MetadataCrypt.cpp
@@ -240,9 +240,10 @@ static bool parse_options(const std::string& options_string, CryptoOptions* opti
 bool fscrypt_mount_metadata_encrypted(const std::string& blk_device, const std::string& mount_point,
                                       bool needs_encrypt, bool should_format,
                                       const std::string& fs_type) {
-    LOG(DEBUG) << "fscrypt_mount_metadata_encrypted: " << mount_point
-               << " encrypt: " << needs_encrypt << " format: " << should_format << " with "
-               << fs_type;
+
+    // Disabled for Halium
+    return false;
+
     auto encrypted_state = android::base::GetProperty("ro.crypto.state", "");
     if (encrypted_state != "" && encrypted_state != "encrypted") {
         LOG(ERROR) << "fscrypt_mount_metadata_encrypted got unexpected starting state: "
-- 
2.39.2

